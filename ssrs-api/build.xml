<project name="ssrs-api" default="rebuild" basedir=".">
  <property name="report-service.wsdl" location="src/resources/ReportService2005.wsdl"/>

  <target name="clean" description="Remove all generated files.">
    <delete dir="target"/>
    <delete dir="generated"/>
  </target>

  <target name="generate">
    <mkdir dir="generated/java"/>
    <exec executable="wsimport.exe" failonerror="true">
      <arg value="${report-service.wsdl}"/>
      <arg value="-Xnocompile"/>
      <arg value="-wsdllocation"/>
      <arg value="ReportService2005.wsdl"/>
      <arg value="-keep"/>
      <arg value="-s"/>
      <arg value="generated/java"/>
      <arg value="-p"/>
      <arg value="iris.ssrs.api"/>
    </exec>
  </target>

  <target name="compile" depends="generate">
    <mkdir dir="target/classes"/>
    <javac destdir="target/classes" debug="true" source="1.5" target="1.5">
      <src path="generated/java"/>
      <src path="src/java"/>
    </javac>
  </target>

  <target name="package" depends="compile">
    <jar file="target/ssrs-api.jar" basedir="target/classes"/>
  </target>

  <target name="rebuild" depends="clean, package"/>
</project>
